# CSV 导入规范

## 概述
本系统是**库存管理系统**，CSV导入功能仅用于导入必要的库存相关数据，避免导入无关字段。

---

## 标准CSV格式

### 必填字段

| 字段名 | 中文名 | 说明 | 示例 | 备注 |
|--------|--------|------|------|------|
| SKU | 商品SKU编号 | `YF-1063` | 系统唯一标识 |
| color | 颜色 | `红色` / `Red` / `01` | 颜色变体 |
| size | 尺寸 | `S` / `M` / `L` | 尺寸变体 |
| quantity | 库存数量 | `10` | 当前库存 |

### 可选字段

| 字段名 | 中文名 | 说明 | 示例 | 备注 |
|--------|--------|------|------|------|
| store_code | 店铺编号 | `rakuten-001` | 多店铺标识 |
| item_name | 商品名称 | `测试商品` | 用于显示 |
| manage_number | 商品管理番号 | `test-001` | 店铺管理用 |

---

## 支持的列名别名

### SKU 字段（优先级从高到低）
1. `システム連携用SKU番号` （系统联动用SKU编号 - 最优先）
2. `SKU`
3. `sku`
4. `sku_number`

### 颜色字段
1. `color`
2. `颜色`
3. `バリエーション項目選択肢1`
4. `option1`
5. `variation1`

### 尺寸字段
1. `size`
2. `尺寸`
3. `バリエーション項目選択肢2`
4. `option2`
5. `variation2`

### 库存数量字段
1. `数量`
2. `在庫数`
3. `quantity`
4. `stock`
5. `stock_quantity`

### 店铺编号字段
1. `store_code`
2. `store_id`
3. `店铺编号`
4. `store`

---

## CSV 示例

### 示例1：单店铺标准格式
```csv
SKU,color,size,quantity,item_name
YF-1063,红色,S,10,测试商品A
YF-1063,红色,M,5,测试商品A
YF-1063,蓝色,S,8,测试商品A
YF-1064,黑色,L,15,测试商品B
```

### 示例2：多店铺格式
```csv
SKU,store_code,color,size,quantity,manage_number
YF-1063,rakuten-001,红色,S,10,R001-S
YF-1063,rakuten-001,红色,M,5,R001-M
YF-1063,amazon-001,红色,S,20,A001-S
```

### 示例3：乐天导出格式（全部.csv）
```csv
システム連携用SKU番号,商品管理番号（商品URL）,商品名,バリエーション項目選択肢1,バリエーション項目選択肢2
SKU001,item-001,商品A,赤色,S
SKU001,item-001,商品A,赤色,M
SKU002,item-002,商品B,青色,L
```

---

## 导入规则

1. **SKU 生成规则**：
   - 基础 SKU（如 `YF-1063`）+ 颜色编码 + 尺寸编码
   - 示例：`YF-1063-RED-S`

2. **店铺关联**：
   - 如果提供 `store_code`，自动将SKU关联到指定店铺
   - 未提供则只创建SKU，不关联店铺

3. **库存处理**：
   - 数量为0：根据 `zero_handling` 参数处理
   - 负数：根据 `zero_handling` 参数处理

4. **重复处理**：
   - 相同SKU已存在：更新商品名和库存
   - 相同SKU未关联店铺：仅关联店铺

---

## 注意事项

1. **编码**：支持 UTF-8 和 Shift-JIS
2. **分隔符**：自动检测逗号或制表符
3. **导入模式**：
   - `metadata_only`：仅更新元数据（商品名等），不更新库存
   - `reset_stock`：重置库存数量

4. **数量为0处理**：
   - `ignore`：跳过数量为0的记录
   - `set_zero`：将库存设为0
   - `zero_negative`：负数归零

---

## 不导入的字段

以下字段将被忽略，不导入：
- 价格相关（price, 価格等）
- 重量、尺寸详情等
- 图片路径
- 描述信息
- 其他非库存关键字段
